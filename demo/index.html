<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
        
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Decode webform</title>
  <link rel="stylesheet" type="text/css" href="example.css"/>
  <script type="text/javascript" src="../sjcl.js"></script>
  <script type="text/javascript" src="form.js"></script>
  <script type="text/javascript" src="example.js"></script>
</head>
<body onload="loaded()">
  <h1>Decode webform</h1>

  <form id="theForm" onsubmit="return false;">
  <div class="column" id="ckey">
  <p>This page can be used to encrypt/decrypt text from Google Doc add-on Decode. It is based on the Stanford Javascript Crypto Library <a href="https://bitwiseshiftleft.github.io/sjcl/demo/"> demo</a>. To get started, just type in a password in the left pane and a secret message in the middle pane, then click "encrypt". Encryption takes place in your browser and we never see the plaintext.</p> 
    <div class="box" id="ppassword">
      <h2>Password</h2>
      <div class="section">
        <label for="password">Password:</label>
        <input type="password" class="wide" name="password" id="password" autocomplete="off" tabindex="1"/>
        <p class="explanation">
          Choose a strong, random password.
        </p>
      </div>
    </div>


    <div id="pplaintext" class="box">
      <h2>Plaintext</h2>
      <div class="section">
        <label for="plaintext">Secret message:</label>
        <textarea id="plaintext" autocomplete="off" rows="5" tabindex="2"></textarea>
        <div class="explanation">
          This message will be encrypted, so that nobody can read it or change it
          without your password.
        </div>
      </div>  
    </div>
 
  
    <div id="buttons">
      <a href="javascript:doEncrypt()" id="encrypt" tabindex="4"><span class="turnDown">encrypt</span></a>
      <a href="javascript:doDecrypt()" id="decrypt" tabindex="6"><span class="turnUp">decrypt</span></a>
    </div>
    
    <div id="pciphertext" class="box">
      <h2>Ciphertext</h2>
      <label for="ciphertext">Ciphertext:</label>
      <textarea id="ciphertext" autocomplete="off" rows="7" tabindex="5"></textarea>
      <div class="explanation">
        Your message, encrypted and authenticated so that nobody can read it
        or change it without your password.
      </div>
    </div>


    <div class="box" id="pkey" hidden>
      <h2>No input required below</h2>

      <div class="section">
        <div>
          <label for="salt">Salt:</label>
          <a class="random floatright" href="javascript:randomize('salt',2,0)">random</a>
        </div>
        <input type="text" id="salt" class="wide hex" autocomplete="off" size="17" maxlength="35"/>
        <input type="checkbox" name="freshsalt" id="freshsalt" autocomplete="off" checked="checked"/>
        <label for="freshsalt">Use fresh random salt for each new password</label>
      </div>

      <!-- cipher key -->
      <div class="section">
        <div>
          <label for="key">Key:</label>
          <!--
          <a class="random floatright" href="javascript:randomizeKey()">random</a>
          -->
        </div>
        <textarea id="key" name="key" class="hex" rows="2" autocomplete="off"></textarea>
      </div>

      <div class="section">
        <div>
          <label for="iv">Initialization vector:</label>
          <a class="random floatright" href="javascript:randomize('iv',4,0)">random</a>
        </div>
        <input type="text" name="iv" id="iv" class="wide hex" size="32" maxlength="35" autocomplete="off"/>
        <input type="checkbox" id="freshiv" autocomplete="off" checked="checked"/>
        <label for="freshiv">Choose a new random IV for every message.</label> 
     </div>
   </div>
  </form>
</body>
</html>
